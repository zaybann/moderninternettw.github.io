<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AllMovieMM Style - á€—á€®á€’á€®á€šá€­á€¯á€™á€»á€¬á€¸</title>
    
    <style>
        /* Base Styles: Dark Theme */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a; /* Dark background */
            color: #ecf0f1; /* Light text color */
        }

        /* Top Bar Styling */
        .topbar {
            background-color: #0d0d0d; 
            padding: 15px 30px;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-img {
            height: 35px; 
            margin-right: 15px;
            cursor: pointer; 
        }

        .topbar h2 {
            margin: 0;
            font-size: 1.6em;
            color: #3498db; 
            font-weight: bold;
        }

        /* Content Area & Layout Container */
        .content-container {
            padding: 20px 30px;
            max-width: 1200px; 
            margin: 20px auto;
        }

        .content-container h2 {
            color: #ecf0f1; 
            margin-bottom: 25px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        /* === á€¡á€“á€­á€€ á€•á€¼á€„á€ºá€†á€„á€ºá€á€»á€€á€º: á„ á€á€¯ á€á€…á€ºá€á€”á€ºá€¸ Grid (á€•á€¯á€¶á€™á€¾á€¬ á€•á€¼á€‘á€¬á€¸á€á€Šá€·á€ºá€¡á€á€­á€¯á€„á€ºá€¸) === */
        .data-grid {
            display: grid;
            /* á€™á€»á€€á€ºá€”á€¾á€¬á€•á€¼á€„á€º á€¡á€€á€»á€šá€ºá€•á€±á€«á€ºá€™á€°á€á€Šá€ºá€•á€¼á€®á€¸ 200px á€™á€¾ 4 á€á€¯á€¡á€‘á€­ á€•á€¼á€á€›á€”á€º */
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px;
        }
        
        /* Video Card Styling */
        .data-card {
            background-color: #2c3e50; 
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            text-align: center;
        }

        .data-card:hover {
            transform: scale(1.03); 
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.5); 
        }

        /* === á€¡á€“á€­á€€ á€•á€¼á€„á€ºá€†á€„á€ºá€á€»á€€á€º: á€•á€¯á€¶ Size á€¡á€¬á€¸á€œá€¯á€¶á€¸ á€á€°á€Šá€®á€…á€±á€›á€”á€º === */
        .card-image {
            width: 100%;
            height: 150px; /* á€•á€¯á€¶á á€¡á€™á€¼á€„á€·á€ºá€€á€­á€¯ á€á€á€ºá€™á€¾á€á€ºá€‘á€¬á€¸á€á€Šá€º */
            object-fit: cover; /* á€•á€¯á€¶á€á€Šá€º á€”á€±á€›á€¬á€¡á€•á€¼á€Šá€·á€º á€–á€¼á€Šá€·á€ºá€…á€±á€•á€¼á€®á€¸ á€™á€°á€›á€„á€ºá€¸ Aspect Ratio á€€á€­á€¯ á€‘á€­á€”á€ºá€¸á€‘á€¬á€¸á€á€Šá€º */
            display: block;
        }

        .card-body {
            padding: 10px;
            min-height: 50px; 
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-body h3 {
            margin: 0;
            font-size: 1em;
            color: #ecf0f1;
            /* á€…á€¬á€á€¬á€¸ á€”á€¾á€…á€ºá€€á€¼á€±á€¬á€„á€ºá€¸á€‘á€­ á€•á€¼á€”á€­á€¯á€„á€ºá€›á€”á€º */
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical;
        }
        
        /* Player & Loading Styles */
        .video-player-page { 
            display: none; 
            padding: 20px; 
            max-width: 900px; 
            margin: 20px auto; 
            background-color: #2c3e50; 
            border-radius: 8px;
        }
        .loading-message { 
            text-align: center; 
            padding: 50px; 
            font-size: 1.2em; 
            color: #95a5a6; 
        }
        .back-button { 
            background-color: #e74c3c; 
            color: white; 
            border: none; 
            padding: 10px 15px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin-bottom: 20px;
        }
        .video-element { 
            width: 100%; 
            min-height: 450px; 
            background-color: black; 
            border-radius: 8px;
        }

    </style>
</head>
<body>

    <div id="user-panel-view">
        <header class="topbar">
            <img src="logo.png" alt="Company Logo" class="logo-img" onclick="showPanel('user-panel-view')">
            <h2>MOVIE CLUB</h2>
        </header>

        <div class="content-container">
            <h2>ğŸ¬ Most Recent Videos</h2>
            
            <div id="loading-status" class="loading-message">
                â³ á€—á€®á€’á€®á€šá€­á€¯ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€›á€šá€°á€”á€±á€•á€«á€á€Šá€º...
            </div>

            <div class="data-grid" id="video-list">
                </div>
        </div>
    </div>
    
    <div id="video-player-view" class="video-player-page">
        <button class="back-button" onclick="showPanel('user-panel-view')">
            &#8592; á€”á€±á€¬á€€á€ºá€á€­á€¯á€· á€•á€¼á€”á€ºá€á€½á€¬á€¸á€›á€”á€º
        </button>
        
        <h1 id="video-title">á€—á€®á€’á€®á€šá€­á€¯ á€á€±á€«á€„á€ºá€¸á€…á€‰á€º</h1>
        
        <video 
            id="video-player" 
            class="video-element" 
            controls 
            preload="metadata"
        >
            á€á€„á€·á€ºá€˜á€›á€±á€¬á€€á€ºá€†á€¬á€á€Šá€º HTML á€—á€®á€’á€®á€šá€­á€¯á€€á€­á€¯ á€™á€•á€¶á€·á€•á€­á€¯á€¸á€•á€«á‹
        </video>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // === (á) Firebase Configuration (Admin.html á€™á€¾ á€€á€°á€¸á€šá€°á€‘á€¬á€¸á€á€Šá€º) ===
        const firebaseConfig = {
            apiKey: "AIzaSyCUk-1FHFjhIVDD4foYuKHM7PyP_A1A1vk",
            authDomain: "twod-aa6c1.firebaseapp.com",
            projectId: "twod-aa6c1",
            storageBucket: "twod-aa6c1.appspot.com",
            messagingSenderId: "674076613631",
            appId: "1:674076613631:android:b21b4027ebe6f6f169e5ca"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const postsRef = database.ref('posts'); // Admin á€á€„á€ºá€‘á€¬á€¸á€á€±á€¬ Data Path

        // === (á‚) DOM Element á€™á€»á€¬á€¸á€€á€­á€¯ á€›á€šá€°á€á€¼á€„á€ºá€¸ ===
        const videoListDiv = document.getElementById('video-list');
        const userPanelView = document.getElementById('user-panel-view');
        const videoPlayerView = document.getElementById('video-player-view');
        const videoPlayerElement = document.getElementById('video-player');
        const videoTitleElement = document.getElementById('video-title');
        const loadingStatus = document.getElementById('loading-status');
        
        let videosData = []; 

        // 1. User Panel á€á€½á€„á€º á€—á€®á€’á€®á€šá€­á€¯ Card á€™á€»á€¬á€¸ á€–á€”á€ºá€á€®á€¸á€•á€¼á€á€á€¼á€„á€ºá€¸
        function renderVideoCards() {
            videoListDiv.innerHTML = ''; 
            
            if (videosData.length === 0) {
                loadingStatus.textContent = 'â›” Admin á€™á€¾ á€á€„á€ºá€‘á€¬á€¸á€á€±á€¬ á€—á€®á€’á€®á€šá€­á€¯á€™á€»á€¬á€¸ á€™á€›á€¾á€­á€á€±á€¸á€•á€«á‹';
                loadingStatus.style.display = 'block';
                return;
            }

            loadingStatus.style.display = 'none'; 

            videosData.forEach(video => {
                const card = document.createElement('div');
                card.className = 'data-card';
                
                // á€•á€¯á€¶á€€á€­á€¯ á€”á€¾á€­á€•á€ºá€œá€­á€¯á€€á€ºá€•á€«á€€ showVideoPlayer function á€€á€­á€¯ á€á€±á€«á€ºá€†á€­á€¯á€™á€Šá€º
                card.onclick = () => showVideoPlayer(video.text, video.videoLink);
                
                card.innerHTML = `
                    <img src="${video.imageLink}" alt="${video.text} Poster" class="card-image">
                    <div class="card-body">
                        <h3>${video.text}</h3>
                    </div>
                `;
                videoListDiv.appendChild(card);
            });
        }
        
        // 2. á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬ á€€á€°á€¸á€•á€¼á€±á€¬á€„á€ºá€¸á€á€¼á€„á€ºá€¸ function (Panel View <-> Video Player View)
        function showPanel(panelId) {
            if (panelId === 'user-panel-view') {
                userPanelView.style.display = 'block';
                videoPlayerView.style.display = 'none';
                videoPlayerElement.pause(); 
                videoPlayerElement.removeAttribute('src'); // src á€€á€­á€¯ á€›á€¾á€„á€ºá€¸á€‘á€¯á€á€ºá€œá€­á€¯á€€á€ºá€á€Šá€º
            } else if (panelId === 'video-player-view') {
                userPanelView.style.display = 'none';
                videoPlayerView.style.display = 'block';
            }
        }

        // 3. á€—á€®á€’á€®á€šá€­á€¯ á€–á€½á€„á€·á€ºá€á€¼á€„á€ºá€¸ function
        function showVideoPlayer(title, url) {
            videoTitleElement.textContent = title;
            videoPlayerElement.src = url;
            
            showPanel('video-player-view'); 
            
            videoPlayerElement.play().catch(error => {
                console.log("Autoplay failed:", error);
            });
        }

        // === (á„) Firebase Database á€™á€¾ Data á€™á€»á€¬á€¸á€€á€­á€¯ á€›á€šá€°á€á€¼á€„á€ºá€¸á€”á€¾á€„á€·á€º á€…á€®á€…á€‰á€ºá€á€¼á€„á€ºá€¸ ===
        postsRef.on('value', (snapshot) => {
            videosData = []; 
            if (snapshot.exists()) {
                
                snapshot.forEach((childSnapshot) => {
                    // Firebase á€€á€”á€± á€›á€œá€¬á€á€²á€· Data á€€á€­á€¯ videosData á€‘á€² á€‘á€Šá€·á€ºá€á€Šá€º
                    videosData.push(childSnapshot.val());
                });
                
                // Data á€¡á€á€…á€ºá€€á€­á€¯ á€¡á€•á€±á€«á€ºá€†á€¯á€¶á€¸á€á€½á€„á€º á€•á€¼á€á€›á€”á€º timestamp á€–á€¼á€„á€·á€º á€…á€®á€…á€‰á€ºá€á€Šá€º
                // b.timestamp - a.timestamp á€á€Šá€º á€¡á€á€…á€ºá€†á€¯á€¶á€¸á€€á€­á€¯ á€¡á€•á€±á€«á€ºá€†á€¯á€¶á€¸á€•á€­á€¯á€·á€›á€”á€º (Descending Order)
                videosData.sort((a, b) => b.timestamp - a.timestamp); 
            }
            
            renderVideoCards();
        }, (error) => {
            console.error("Firebase Database á€™á€¾ Data á€›á€šá€°á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€–á€¼á€…á€ºá€á€Šá€º:", error);
            loadingStatus.textContent = `âŒ Data á€›á€šá€°á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€–á€¼á€…á€ºá€á€Šá€º: ${error.message}`;
            loadingStatus.style.display = 'block';
        });

        showPanel('user-panel-view');
        
    </script>

</body>
</html>
