<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invite Friends - One Star</title>
    <style>
        :root { 
            --primary-yellow: #FFD700; 
            --accent-red: #FF5252; 
        }
        body { 
            font-family: 'Pyidaungsu', sans-serif; background: #f8f9fa; 
            margin: 0; padding: 15px; text-align: center;
        }

        /* --- Loading Screen --- */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 9999; display: flex;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .loader {
            border: 4px solid #f3f3f3; border-top: 4px solid var(--primary-yellow);
            border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .header { 
            background: var(--primary-yellow); padding: 18px; border-radius: 15px;
            font-weight: bold; margin-bottom: 20px; color: #d35400;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .invite-card {
            background: white; padding: 25px; border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px;
        }
        .invite-icon { font-size: 50px; margin-bottom: 10px; }
        .referral-box {
            background: #f1f3f5; padding: 15px; border-radius: 12px;
            border: 2px dashed #adb5bd; margin: 15px 0;
            font-size: 24px; font-weight: bold; color: var(--accent-red);
            letter-spacing: 2px;
        }
        .btn-copy {
            background: var(--accent-red); color: white; border: none;
            padding: 10px 25px; border-radius: 10px; font-weight: bold;
            cursor: pointer; width: 100%; font-size: 16px;
        }

        .stat-item {
            background: #fff3e0; padding: 15px; border-radius: 12px;
            border-left: 5px solid #ff9800; text-align: left;
        }

        #toast {
            visibility: hidden; min-width: 200px; background-color: #333; color: #fff;
            text-align: center; border-radius: 10px; padding: 10px; position: fixed;
            z-index: 10000; left: 50%; bottom: 30px; transform: translateX(-50%);
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body>

<div id="loading-screen">
    <div class="loader"></div>
    <p style="margin-top:15px;">á€á€á€…á€±á€¬á€„á€·á€ºá€•á€±á€¸á€•á€«...</p>
</div>

<div id="toast">Referral ID á€€á€­á€¯ á€€á€°á€¸á€šá€°á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®</div>

<div class="header">ğŸ‘¥ á€á€°á€„á€šá€ºá€á€»á€„á€ºá€¸á€™á€»á€¬á€¸á€€á€­á€¯ á€–á€­á€á€ºá€á€±á€«á€ºá€•á€«</div>

<div class="invite-card">
    <div class="invite-icon">ğŸ</div>
    <h3 style="margin:0;">á€á€°á€„á€šá€ºá€á€»á€„á€ºá€¸á€™á€»á€¬á€¸á€€á€­á€¯ á€–á€­á€á€ºá€á€±á€«á€ºá€•á€¼á€®á€¸</h3>
    <p style="color:#666; font-size: 14px;">á€¡á€•á€­á€¯á€†á€¯á€€á€¼á€±á€¸á€™á€»á€¬á€¸ á€›á€šá€°á€œá€­á€¯á€€á€ºá€•á€«</p>
    
    <div class="referral-box" id="refCode">------</div>
    <button class="btn-copy" onclick="copyRef()">ID á€€á€­á€¯ á€€á€°á€¸á€šá€°á€™á€Šá€º ğŸ“‹</button>
</div>

<div class="stat-item">
    <h4 style="margin:0; color:#e65100;">á€–á€­á€á€ºá€á€±á€«á€ºá€‘á€¬á€¸á€á€° á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸</h4>
    <h2 style="margin:5px 0 0;" id="invitedCount">0 á€šá€±á€¬á€€á€º</h2>
</div>

<div style="margin-top:25px; text-align: left; background: white; padding: 15px; border-radius: 15px; font-size: 13px; color: #555;">
    <b>á€…á€Šá€ºá€¸á€€á€™á€ºá€¸á€á€»á€€á€ºá€™á€»á€¬á€¸-</b><br>
    áá‹ á€™á€­á€™á€­á ID á€€á€­á€¯ á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á á€¡á€€á€±á€¬á€„á€·á€ºá€á€…á€ºá€–á€½á€„á€·á€ºá€á€­á€¯á€„á€ºá€¸á€•á€«á‹<br>
    á‚á‹ á€á€°á€„á€šá€ºá€á€»á€„á€ºá€¸ á€¡á€€á€±á€¬á€„á€·á€ºá€–á€½á€„á€·á€ºá€•á€¼á€®á€¸á€œá€»á€¾á€„á€º á€á€„á€·á€ºá€‘á€¶á€á€­á€¯á€· á€†á€¯á€€á€¼á€±á€¸á€™á€»á€¬á€¸ á€¡á€œá€­á€¯á€¡á€œá€»á€±á€¬á€€á€º á€›á€±á€¬á€€á€ºá€›á€¾á€­á€•á€«á€™á€Šá€ºá‹
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCUk-1FHFjhIVDD4foYuKHM7PyT_A1A1vk",
        authDomain: "twod-aa6c1.firebaseapp.com",
        projectId: "twod-aa6c1",
        storageBucket: "twod-aa6c1.appspot.com",
        messagingSenderId: "674076613631",
        appId: "1:674076613631:android:b21b4027ebe6f6f169e5ca"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let myReferralID = "";

    firebase.auth().onAuthStateChanged(user => {
        if (user) {
            db.collection("users").doc(user.uid).get().then(doc => {
                if (doc.exists) {
                    myReferralID = doc.data().userId || "";
                    document.getElementById('refCode').innerText = myReferralID;
                    fetchInvitedCount(myReferralID);
                }
                document.getElementById('loading-screen').style.display = 'none';
            });
        } else {
            window.location.href = "index.html";
        }
    });

    function fetchInvitedCount(refID) {
        db.collection("users").where("referralFrom", "==", refID)
          .onSnapshot(snapshot => {
              document.getElementById('invitedCount').innerText = snapshot.size + " á€šá€±á€¬á€€á€º";
          });
    }

    function copyRef() {
        if (!myReferralID) return;
        navigator.clipboard.writeText(myReferralID).then(() => {
            const toast = document.getElementById("toast");
            toast.className = "show";
            setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
        });
    }
</script>
<script src="https://3nbf4.com/act/files/tag.min.js?z=10549378" data-cfasync="false" async></script>
</body>
    </html>
